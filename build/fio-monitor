# Use an official Python runtime as a parent image
FROM python:3.13.9-slim-trixie
#
RUN apt-get update && apt-get install -y ca-certificates fio && update-ca-certificates && rm -rf /var/lib/apt/lists/*
# Set the working directory in the container
WORKDIR /app
# Create a virtual environment
RUN python -m venv /opt/venv
# Activate the virtual environment and add it to the PATH
ENV PATH="/opt/venv/bin:$PATH"
# Copy the requirements file into the container
COPY requirements.txt .
# Install any needed packages specified in requirements.txt
RUN pip install --upgrade pip
#RUN pip install --no-cache-dir -r requirements.txt
RUN pip install --trusted-host pypi.org --trusted-host pypi.python.org --trusted-host files.pythonhosted.org --no-cache-dir -r requirements.txt
# Copy the rest of your application code into the container
COPY ./fio-monitor/ ./
# Define the command to run your application
#CMD ["sleep", "infinity"]
CMD ["python", "./fio_monitor.py", "--config", "fio_configs.json", "--interval", "1"]